{"ast":null,"code":"import { useState } from \"react\";\nexport default function useGenerateCsf(yearlyTasks, driversList) {\n  const [csvInterval, setCsvInterval] = useState({\n    id: 2,\n    name: \"2 days\"\n  });\n  const [driverSelected, setDriverSelected] = useState(driversList[0]);\n  const possibleInterval = [{\n    id: 2,\n    name: \"2 days\"\n  }, {\n    id: 4,\n    name: \"4 days\"\n  }, {\n    id: 7,\n    name: \"7 days\"\n  }, {\n    id: 14,\n    name: \"14 days\"\n  }, {\n    id: 28,\n    name: \"28 days\"\n  }];\n\n  function summarizeDriverActivities() {\n    const intervalDuration = csvInterval.id; // find all task of the driver selected\n\n    const driverTasks = yearlyTasks.filter(task => task.driver.id == driverSelected.id); // generate the accumulator object used to tally tasks\n\n    let initialAccumulator = {};\n\n    for (let i = 0; i < 364; i++) {\n      // if beginning of interval\n      if (i % intervalDuration) {\n        initialAccumulator[i] = {\n          pickup: 0,\n          dropoff: 0,\n          other: 0\n        };\n      }\n    }\n\n    function sumEachInterval(accumulator, tasks) {\n      return tasks.reduce((accumulator, task) => {\n        const taskDay = Math.floor(task.time.start % 24);\n        /* ex: for day 5 at 2 day interval, the interval \n        which it belongs to is 4 - 5. so taskInterval = 4*/\n\n        const taskInterval = taskDay - taskDay % intervalDuration;\n        const newAccumulator = { ...accumulator\n        };\n        newAccumulator[taskInterval][task.type] += 1;\n        return newAccumulator;\n      });\n    }\n\n    function transformToCsvShape(data) {\n      output = [];\n\n      for (const [intervalStartDay, tally] of data) {\n        output.push({\n          timeFrame: `Day ${intervalStartDay} - Day ${intervalStartDay + intervalDuration}`,\n          ...tally\n        });\n      }\n    } // sumEachInterval(initialAccumulator)\n\n  }\n\n  return {\n    csvInterval,\n    setCsvInterval,\n    possibleInterval,\n    driverSelected,\n    setDriverSelected\n  };\n}","map":{"version":3,"sources":["/home/momo/portfolio/roseRocket/client/src/components/Calendar/CalendarSidebar/GenerateCsv/useGenerateCsv.js"],"names":["useState","useGenerateCsf","yearlyTasks","driversList","csvInterval","setCsvInterval","id","name","driverSelected","setDriverSelected","possibleInterval","summarizeDriverActivities","intervalDuration","driverTasks","filter","task","driver","initialAccumulator","i","pickup","dropoff","other","sumEachInterval","accumulator","tasks","reduce","taskDay","Math","floor","time","start","taskInterval","newAccumulator","type","transformToCsvShape","data","output","intervalStartDay","tally","push","timeFrame"],"mappings":"AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,eAAe,SAASC,cAAT,CAAwBC,WAAxB,EAAqCC,WAArC,EAAkD;AAC/D,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCL,QAAQ,CAAC;AAAEM,IAAAA,EAAE,EAAE,CAAN;AAASC,IAAAA,IAAI,EAAE;AAAf,GAAD,CAA9C;AACA,QAAM,CAACC,cAAD,EAAiBC,iBAAjB,IAAsCT,QAAQ,CAACG,WAAW,CAAC,CAAD,CAAZ,CAApD;AACA,QAAMO,gBAAgB,GAAG,CACvB;AAAEJ,IAAAA,EAAE,EAAE,CAAN;AAASC,IAAAA,IAAI,EAAE;AAAf,GADuB,EAEvB;AAAED,IAAAA,EAAE,EAAE,CAAN;AAASC,IAAAA,IAAI,EAAE;AAAf,GAFuB,EAGvB;AAAED,IAAAA,EAAE,EAAE,CAAN;AAASC,IAAAA,IAAI,EAAE;AAAf,GAHuB,EAIvB;AAAED,IAAAA,EAAE,EAAE,EAAN;AAAUC,IAAAA,IAAI,EAAE;AAAhB,GAJuB,EAKvB;AAAED,IAAAA,EAAE,EAAE,EAAN;AAAUC,IAAAA,IAAI,EAAE;AAAhB,GALuB,CAAzB;;AAOA,WAASI,yBAAT,GAAqC;AACnC,UAAMC,gBAAgB,GAAGR,WAAW,CAACE,EAArC,CADmC,CAEnC;;AACA,UAAMO,WAAW,GAAGX,WAAW,CAACY,MAAZ,CACjBC,IAAD,IAAUA,IAAI,CAACC,MAAL,CAAYV,EAAZ,IAAkBE,cAAc,CAACF,EADzB,CAApB,CAHmC,CAMnC;;AACA,QAAIW,kBAAkB,GAAG,EAAzB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;AAC5B;AACA,UAAIA,CAAC,GAAGN,gBAAR,EAA0B;AACxBK,QAAAA,kBAAkB,CAACC,CAAD,CAAlB,GAAwB;AAAEC,UAAAA,MAAM,EAAE,CAAV;AAAaC,UAAAA,OAAO,EAAE,CAAtB;AAAyBC,UAAAA,KAAK,EAAE;AAAhC,SAAxB;AACD;AACF;;AACD,aAASC,eAAT,CAAyBC,WAAzB,EAAsCC,KAAtC,EAA6C;AAC3C,aAAOA,KAAK,CAACC,MAAN,CAAa,CAACF,WAAD,EAAcR,IAAd,KAAuB;AACzC,cAAMW,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWb,IAAI,CAACc,IAAL,CAAUC,KAAV,GAAkB,EAA7B,CAAhB;AACA;;;AAEA,cAAMC,YAAY,GAAGL,OAAO,GAAIA,OAAO,GAAGd,gBAA1C;AACA,cAAMoB,cAAc,GAAG,EAAE,GAAGT;AAAL,SAAvB;AACAS,QAAAA,cAAc,CAACD,YAAD,CAAd,CAA6BhB,IAAI,CAACkB,IAAlC,KAA2C,CAA3C;AACA,eAAOD,cAAP;AACD,OARM,CAAP;AASD;;AACD,aAASE,mBAAT,CAA6BC,IAA7B,EAAmC;AACjCC,MAAAA,MAAM,GAAG,EAAT;;AACA,WAAK,MAAM,CAACC,gBAAD,EAAmBC,KAAnB,CAAX,IAAwCH,IAAxC,EAA8C;AAC5CC,QAAAA,MAAM,CAACG,IAAP,CAAY;AACVC,UAAAA,SAAS,EAAG,OAAMH,gBAAiB,UACjCA,gBAAgB,GAAGzB,gBACpB,EAHS;AAIV,aAAG0B;AAJO,SAAZ;AAMD;AACF,KAnCkC,CAoCnC;;AACD;;AACD,SAAO;AACLlC,IAAAA,WADK;AAELC,IAAAA,cAFK;AAGLK,IAAAA,gBAHK;AAILF,IAAAA,cAJK;AAKLC,IAAAA;AALK,GAAP;AAOD","sourcesContent":["import { useState } from \"react\";\nexport default function useGenerateCsf(yearlyTasks, driversList) {\n  const [csvInterval, setCsvInterval] = useState({ id: 2, name: \"2 days\" });\n  const [driverSelected, setDriverSelected] = useState(driversList[0]);\n  const possibleInterval = [\n    { id: 2, name: \"2 days\" },\n    { id: 4, name: \"4 days\" },\n    { id: 7, name: \"7 days\" },\n    { id: 14, name: \"14 days\" },\n    { id: 28, name: \"28 days\" },\n  ];\n  function summarizeDriverActivities() {\n    const intervalDuration = csvInterval.id;\n    // find all task of the driver selected\n    const driverTasks = yearlyTasks.filter(\n      (task) => task.driver.id == driverSelected.id\n    );\n    // generate the accumulator object used to tally tasks\n    let initialAccumulator = {};\n    for (let i = 0; i < 364; i++) {\n      // if beginning of interval\n      if (i % intervalDuration) {\n        initialAccumulator[i] = { pickup: 0, dropoff: 0, other: 0 };\n      }\n    }\n    function sumEachInterval(accumulator, tasks) {\n      return tasks.reduce((accumulator, task) => {\n        const taskDay = Math.floor(task.time.start % 24);\n        /* ex: for day 5 at 2 day interval, the interval \n        which it belongs to is 4 - 5. so taskInterval = 4*/\n        const taskInterval = taskDay - (taskDay % intervalDuration);\n        const newAccumulator = { ...accumulator };\n        newAccumulator[taskInterval][task.type] += 1;\n        return newAccumulator;\n      });\n    }\n    function transformToCsvShape(data) {\n      output = [];\n      for (const [intervalStartDay, tally] of data) {\n        output.push({\n          timeFrame: `Day ${intervalStartDay} - Day ${\n            intervalStartDay + intervalDuration\n          }`,\n          ...tally,\n        });\n      }\n    }\n    // sumEachInterval(initialAccumulator)\n  }\n  return {\n    csvInterval,\n    setCsvInterval,\n    possibleInterval,\n    driverSelected,\n    setDriverSelected,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}