{"ast":null,"code":"import { useState } from \"react\";\n/*\n  I couldn't find a good library that implements time on \n  a 24 h / 7 day / 52 week discrete timescale. Popular libraries \n  like MomentJS are implemented in real world timescales. \n  For simplicity sake, I ended up just writing the way the \n  time works myself.\n */\n\nexport default function useCalendar() {\n  /* I've elected to use useState instead of useReducer because the various states \n  don't really rely on the value of another state in order to update*/\n\n  /* Time 0 is set set arbitrarily to some point in the spacetime\n  Each increment of 1 represents the passing of one hour\n  Not sure if this is the best way to keep track of time\n  Can switch to momentJS in the future\n  No use for time state right now since not using real world time\n  */\n  // const [time, setTime] = useState(0);\n  // weeks starts incrementing at 0\n  const [calendarTime, setCalendarTime] = useState(0); // state responsible for controlled input of calendar header weeks\n\n  const [weekInput, setWeekInput] = useState(calendarTime); // keep track of which drivers fall under the dispatcher each year\n  // and whether they are shown on the calendar\n\n  const driversTemp = [{\n    id: 1,\n    name: \"bob\",\n    selected: true\n  }, {\n    id: 2,\n    name: \"joe\",\n    selected: true\n  }]; // convert array of drivers to Map\n  // this allows easier lookup with driver.id and looping\n\n  const initialDrivers = new Map(driversTemp.map(driver => [driver.id, driver]));\n  const [drivers, setDrivers] = useState(initialDrivers);\n\n  const toggleDriverSelected = function (driverId) {\n    setDrivers(prev => {\n      console.log('old', prev); // // construct new state where driver's selected bool is toggled\n\n      const newState = new Map(prev);\n      const toggledDriver = newState.get(driverId); // invert driver selected property\n\n      toggledDriver.selected = !toggledDriver.selected;\n      console.log('new', newState);\n      return newState.set(driverId, toggledDriver);\n    });\n  };\n\n  const timeRatio = {\n    hour: 1,\n    day: 24,\n    week: 168,\n    year: 8736\n  };\n\n  const convertTime = function (time, from, to) {\n    return time * (timeRatio[from] / timeRatio[to]);\n  }; // number of week into the year\n\n\n  const week = convertTime(calendarTime % timeRatio.year, \"hour\", \"week\");\n\n  const changeWeekBy = n => {\n    setCalendarTime(prev => {\n      const newWeek = prev + n * timeRatio.week; // Don't allow negative weeks\n\n      return newWeek >= 0 ? newWeek : prev;\n    });\n  }; // return which day of the week and what hour in 24hr\n\n\n  const findDayAndHourFromTime = function (time) {\n    const day = Math.floor(time % timeRatio.week / timeRatio.day);\n    const hour = time % timeRatio.day;\n    return {\n      day,\n      hour\n    };\n  }; // handles controlled input of calendar header\n\n\n  const handleOnChange = function (e) {\n    const newValue = e.target.value.trim(); // number must be between 0-51 included\n\n    console.log(weekInput);\n    const re = /^([0-9]|[1-4][0-9]|5[01])$/;\n    setWeekInput(prev => {\n      if (re.test(newValue) || newValue === \"\") {\n        return newValue;\n      } else {\n        return prev;\n      }\n    });\n  }; // change week to selected week from week input box\n\n\n  const handleWeekJump = function () {\n    const weekDifference = weekInput - week;\n    console.log(weekDifference);\n    changeWeekBy(weekDifference);\n  }; // temp data\n\n\n  let weeklyTasks = [];\n\n  if (week === 0) {\n    //api response placeholder\n    weeklyTasks = [{\n      name: \"task1\",\n      detail: \"very cool\",\n      time: 100,\n      driver: {\n        id: 1,\n        name: \"bob\"\n      }\n    }]; //transform data to indicate day and time\n\n    weeklyTasks = weeklyTasks.map(task => ({ ...task,\n      time: findDayAndHourFromTime(task.time)\n    }));\n  }\n\n  if (week === 1) {\n    weeklyTasks = [{\n      name: \"task2\",\n      detail: \"super cool\",\n      time: 200,\n      driver: {\n        id: 2,\n        name: \"joe\"\n      }\n    }];\n    weeklyTasks = weeklyTasks.map(task => ({ ...task,\n      time: findDayAndHourFromTime(task.time)\n    }));\n  }\n\n  return {\n    changeWeekBy,\n    week,\n    weeklyTasks,\n    weekInput,\n    handleOnChange,\n    handleWeekJump,\n    drivers: Array.from(drivers.values()),\n    toggleDriverSelected\n  };\n}","map":{"version":3,"sources":["/home/momo/portfolio/roseRocket/client/src/components/Calendar/useCalendar.js"],"names":["useState","useCalendar","calendarTime","setCalendarTime","weekInput","setWeekInput","driversTemp","id","name","selected","initialDrivers","Map","map","driver","drivers","setDrivers","toggleDriverSelected","driverId","prev","console","log","newState","toggledDriver","get","set","timeRatio","hour","day","week","year","convertTime","time","from","to","changeWeekBy","n","newWeek","findDayAndHourFromTime","Math","floor","handleOnChange","e","newValue","target","value","trim","re","test","handleWeekJump","weekDifference","weeklyTasks","detail","task","Array","values"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\n\n/*\n  I couldn't find a good library that implements time on \n  a 24 h / 7 day / 52 week discrete timescale. Popular libraries \n  like MomentJS are implemented in real world timescales. \n  For simplicity sake, I ended up just writing the way the \n  time works myself.\n */\nexport default function useCalendar() {\n  /* I've elected to use useState instead of useReducer because the various states \n  don't really rely on the value of another state in order to update*/\n  /* Time 0 is set set arbitrarily to some point in the spacetime\n  Each increment of 1 represents the passing of one hour\n  Not sure if this is the best way to keep track of time\n  Can switch to momentJS in the future\n  No use for time state right now since not using real world time\n  */\n  // const [time, setTime] = useState(0);\n  // weeks starts incrementing at 0\n  const [calendarTime, setCalendarTime] = useState(0);\n  // state responsible for controlled input of calendar header weeks\n  const [weekInput, setWeekInput] = useState(calendarTime);\n  // keep track of which drivers fall under the dispatcher each year\n  // and whether they are shown on the calendar\n  const driversTemp = [\n    { id: 1, name: \"bob\", selected: true },\n    { id: 2, name: \"joe\", selected: true },\n  ];\n  // convert array of drivers to Map\n  // this allows easier lookup with driver.id and looping\n  const initialDrivers = new Map(\n    driversTemp.map((driver) => [driver.id, driver])\n  );\n  const [drivers, setDrivers] = useState(initialDrivers);\n\n  const toggleDriverSelected = function (driverId) {\n    setDrivers((prev) => {\n      console.log('old', prev)\n      // // construct new state where driver's selected bool is toggled\n      const newState = new Map(prev);\n      const toggledDriver = newState.get(driverId);\n      // invert driver selected property\n      toggledDriver.selected = !toggledDriver.selected;\n      console.log('new', newState)\n      return newState.set(driverId, toggledDriver);\n    });\n  };\n  const timeRatio = {\n    hour: 1,\n    day: 24,\n    week: 168,\n    year: 8736,\n  };\n\n  const convertTime = function (time, from, to) {\n    return time * (timeRatio[from] / timeRatio[to]);\n  };\n  // number of week into the year\n  const week = convertTime(calendarTime % timeRatio.year, \"hour\", \"week\");\n\n  const changeWeekBy = (n) => {\n    setCalendarTime((prev) => {\n      const newWeek = prev + n * timeRatio.week;\n      // Don't allow negative weeks\n      return newWeek >= 0 ? newWeek : prev;\n    });\n  };\n  // return which day of the week and what hour in 24hr\n  const findDayAndHourFromTime = function (time) {\n    const day = Math.floor((time % timeRatio.week) / timeRatio.day);\n    const hour = time % timeRatio.day;\n    return { day, hour };\n  };\n\n  // handles controlled input of calendar header\n  const handleOnChange = function (e) {\n    const newValue = e.target.value.trim();\n    // number must be between 0-51 included\n    console.log(weekInput);\n    const re = /^([0-9]|[1-4][0-9]|5[01])$/;\n    setWeekInput((prev) => {\n      if (re.test(newValue) || newValue === \"\") {\n        return newValue;\n      } else {\n        return prev;\n      }\n    });\n  };\n\n  // change week to selected week from week input box\n  const handleWeekJump = function () {\n    const weekDifference = weekInput - week;\n    console.log(weekDifference);\n    changeWeekBy(weekDifference);\n  };\n\n  // temp data\n  let weeklyTasks = [];\n  if (week === 0) {\n    //api response placeholder\n    weeklyTasks = [\n      {\n        name: \"task1\",\n        detail: \"very cool\",\n        time: 100,\n        driver: { id: 1, name: \"bob\" },\n      },\n    ];\n    //transform data to indicate day and time\n    weeklyTasks = weeklyTasks.map((task) => ({\n      ...task,\n      time: findDayAndHourFromTime(task.time),\n    }));\n  }\n  if (week === 1) {\n    weeklyTasks = [\n      {\n        name: \"task2\",\n        detail: \"super cool\",\n        time: 200,\n        driver: { id: 2, name: \"joe\" },\n      },\n    ];\n    weeklyTasks = weeklyTasks.map((task) => ({\n      ...task,\n      time: findDayAndHourFromTime(task.time),\n    }));\n  }\n\n  return {\n    changeWeekBy,\n    week,\n    weeklyTasks,\n    weekInput,\n    handleOnChange,\n    handleWeekJump,\n    drivers: Array.from(drivers.values()),\n    toggleDriverSelected,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}